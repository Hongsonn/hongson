# SmokePing

- **SmokePing** là công cụ đo độ trễ. SmokePing có thể đo lường, lưu trữ, hiển thị độ trễ và sự mất gói tin trên biểu đồ

## I. Cài đặt:

### 1. Cài đặt SmokePing:

- Khai báo repos và các gói cần thiết:

```
yum -y update 
yum groupinstall "Development tools" -y
yum -y install epel-release wget curl httpd postfix
```

- Cài đặt SmokePing: `yum -y install smokeping`

### 2. Cấu hình Webserver:

- Tạo file backup config: `cp /etc/httpd/conf.d/smokeping.conf /etc/httpd/conf.d/smokeping.conf.bak`
- Sửa file `/etc/httpd/conf.d/smokeping.conf` thành nội dung như sau:

```
<Directory "/usr/share/smokeping" >
  Options +ExecCGI
  Require all granted
</Directory>

<Directory "/var/lib/smokeping" >
  Require all granted
</Directory>

ScriptAlias /smokeping/sm.cgi /usr/share/smokeping/cgi/smokeping.fcgi
ScriptAlias /smokeping/smokeping.cgi /usr/share/smokeping/cgi/smokeping.fcgi

Alias /smokeping/images /var/lib/smokeping/images
Alias /smokeping /usr/share/smokeping/htdocs

RedirectMatch permanent "^/smokeping/?$" "/"
RedirectMatch permanent "^/smokeping/smokeping.cgi" "/"
RedirectMatch permanent "^/smokeping/sm.cgi" "/"
```

- Sửa file cấu hình `/etc/httpd/conf/httpd.conf`:
   - Tìm dòng `DirectoryIndex index.html` (dòng 164) và thay thế `DirectoryIndex index.html smokeping.fcgi`
   - Sửa dòng `DocumentRoot "/var/www/html"` (dòng 119) và thay thế `DocumentRoot "/usr/share/smokeping/cgi"`

### 3. Cấu hình SmokePing:

- File cấu hình: `/etc/smokeping/config`
- Các thành phần trong file cấu hình:

  - Phần **Genaral**: Cá nhân hóa file cấu hình, phục vụ cho phần cảnh báo
  - Phần **Alerts**: Cảnh báo
  - Phần **Database**: Mặc định step = 300, ping = 20. Tức là trong 300s sẽ có 20 gói tin ICMP được gửi tới các host. 300s sẽ có dữ liệu hiển thị 1 lần trên biểu đồ.
  - Phần **Presentation**: Hiển thị 1 số biểu đồ để so sánh. Có 1 menu mặc định là `Charts`. Trong menu có biểu hiện các biểu đồ độ lệnh chuẩn cao nhất, biểu đồ hiện thị các host có giá trị Roundtrip Time cao nhất, biểu đồ hiện thị host có số loss packet cao nhất, biểu đồ hiển thị hosts có Median Roundrip Time cao nhất.
     - Các biểu đồ được hiển thị theo thời gian, ta có thế cấu hình để điều chỉnh thời gian của các biểu đồ.
  - Phần **Probes**: Công cụ dò, mặc định là Fping
  - Phần **Targets**: Ta có thể thêm các host muốn theo dõi tại đây:

```

+ Site1-FPT

menu = Site1-FPT
title = Site1-FPT

++ Host1-140

menu = Host1
title = 103.28.39.144
host = 103.28.39.144

++ Host2-141

menu = Host2
title = 103.28.39.213
host = 103.28.39.213

+ Site2-NH

menu = Site2-NH
title = Site2-NH

++ NhanHoa

menu = NhanHoa
title = NhanHoa
host = nhanhoa.com
```




